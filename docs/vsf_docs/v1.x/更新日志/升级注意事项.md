# 升级注意事项

我们正在努力使升级过程尽可能简单。不幸的是，有时需要手动更改代码。在拉出最新版本之前，请先看看下面的升级说明：

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-11-1-12)1.11 -> 1.12

添加到 1.12 的大多数更改都是向后兼容的。要启用新功能（主要是优化功能），请按照以下步骤操作。

**删除健美和压缩 API 响应**

`api-search-query`添加了新的搜索适配器。当您切换到它时，通过设置`config.server.api = "api-search-query"`正在构建的 ElasticSearch 查询[`vue-storefront-api` （打开新窗口）](https://github.com/vuestorefront/vue-storefront-api/pull/390)这节省了大约 400kB 的包大小，因为`bodybuilder`前端不再需要。

这个新`api-search-query`适配器支持`response_format`现在发送到`/api/catalog`端点的查询参数。目前仅支持一种附加格式：`response_format=compact`. 使用时，响应格式通过以下方式得到优化： a) 重新映射结果，`_source`从`hits.hits`; b) 根据 压缩 JSON 字段名称`config.products.fieldsToCompact`；c) 从`product.configurable_children`它们的值 === 父产品值中删除 JSON 字段；整体响应大小减少了 -70% 以上。

**重新启用放大器渲染器**

该`amp-renderer`模块已默认禁用以保存捆绑包大小；如果您想启用它从取消注释模块`src/modules`并取消`product-amp`和`category-amp`被添加到链接`<head>`部分中`src/themes/default/Product.vue`和`src/themes/default/Category.vue`

**检查实体优化设置**

如果实体优化被禁用，购物车优化会自动禁用。现在它们可以彼此独立使用。如果您不想使用购物车优化，请确保`entities.optimizeShoppingCart`明确禁用配置条目。

**已弃用的操作和助手**

产品模块已经重构，这里是不再使用的操作列表，您可以删除它们以减少捆绑。

- 弃用的操作：
  - 产品/重置
  - 产品/设置面包屑
  - 产品/syncPlatformPricesOver
  - 产品/设置相关
  - 产品/负载可配置属性
  - 产品/设置变体
  - product/filterUnavailableVariants
  - 产品列表
  - 产品/预配置关联
  - 产品/预配置产品
  - 产品/配置LoadedProducts
  - 产品/配置BundleAsync
  - 产品/配置GroupedAsync
  - 产品/配置
  - 产品/设置当前选项
  - 产品/设置当前错误
  - 产品/套原件
  - 产品/加载产品属性
  - 类别/列表（新动作是 category-next/fetchMenuCategories）
- 弃用的助手：
  - 配置产品异步
  - 填充产品配置异步
  - setConfigurableProductOptionsAsync

以下是从 1.12 开始在产品模块中使用的操作列表：

- 产品/doPlatformPricesSync
- 产品/单个
- 产品/检查ConfigurableParent
- 产品/查找产品
- 产品/查找ConfigurableParent
- 产品/设置自定义选项
- 产品/setBundleOptions
- 产品/集当前
- 产品/负载产品
- 产品/添加CustomOptionValidator
- 产品/套装ProductGallery
- product/loadProductBreadcrumbs
- 产品/获取产品变体

所有不推荐使用的操作和助手都可以删除，因此您将拥有更小的包。评论这些行：

- 核心/模块/目录/商店/产品/actions.ts:318
- 核心/模块/目录/helpers/index.ts:14-18
- 核心/模块/catalog-next/store/category/actions.ts:265

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-10-1-11)1.10 -> 1.11

这是 Vue Storefront 1.x 在 2.0 之前的最后一个主要版本，因此需要更多的手动更新以尽可能长时间地保持外部包与 1.x 兼容。

- `src/modules/index.ts`重命名为`client.ts`，导出的属性重命名为`registerClientModules`
- 增加了输出压缩模块；它在生产版本中默认启用；要禁用它，请切换`src/modules/server.ts`配置
- 这 [`formatCategoryLink` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/develop/core/modules/url/helpers/index.ts)现在支持 multistore -`storeCode`必要时添加；它可能会导致双重存储前缀，例如`/de/de`- 但可能仅在面包屑中（#3359）
- 所有模块都重构为新的 API。在 2.0 之前，您仍然可以以以前的格式注册模块
- `DroppointShipping`和`magento-2-cms`模块被删除
- 示例模块移至 https://github.com/vuestorefront/vsf-samples
- `core/helpers/initCacheStorage.ts`合并`StorageManager.ts`（添加了向后兼容的导入路径别名）
- 旧的扩展机制（VS 1.4之前）在被弃用近一年后终于被移除（`src/extensions`移除）
- 缓存集合被重组。在大多数情况下，本地存储键保持不变，只有集合键是统一的。它们也仅用于核心。发布更改以防有人在其模块中使用这些集合；
  - `syncTaskCollection` 重命名为 `syncTasks`
  - `compareCollection` 重命名为 `compare`
  - `cmsData` 重命名为 `cms`
  - `cartsCollection` 重命名为 `carts`
  - `checkoutFieldValues`,`checkoutFieldsCollection`重命名为`checkout`(`checkoutFieldsCollection`未使用)
  - `ordersCollection`并`orders`更名为刚`orders`（`ordersCollection`未使用）
  - `elasticCacheCollection` 重命名为 `elasticCache`
  - `usersCollection` `usersData` 合并并重命名为 `user`
  - `attributesCollection`,`attributes`重命名为 just`attributes`
  - `ordersHistoryCollection`合并到`user`它所属的缓存
  - `categoriesCollection` 重命名为类别
  - 主题中的集合`claimsCollection`（索赔模块）保持不变
- `UserOrder`组件已重命名为`UserOrderHistory`并从`src/modules/order-history/components/UserOrders`移至`@vue-storefront/core/modules/order/components/UserOrdersHistory`. 此组件用于`MyOrders`此处找到的组件：`src/themes/default/components/core/blocks/MyAccount/MyOrders.vue`。在此文件`import`中，必须更新路径。
- `claims`，`promoted-offers`，`homepage`和`ui`模块已经从移动`@vue-storefront/src/modules`到`src/themes/default/store/`和减少到只存储。
  删除这些文件夹：
  \- `src/modules/claims`
  \- `src/modules/promoted-offers`
  \- `src/modules/homepage`
  -`src/modules/ui-store`
  复制文件夹`theme/store/`的`theme default`。
  注册在`src/themes/default/index.js`. 为此，将它们与`StorageManager`方法一起导入，用于替换`claims beforeRegistration hook`.

```js
import { StorageManager } from '@vue-storefront/core/lib/storage-manager';
import { store as claimsStore } from 'theme/store/claims'
import { store as homeStore } from 'theme/store/homepage'
import { store as uiStore } from 'theme/store/ui'
import { store as promotedStore } from 'theme/store/promoted-offers'
```

接下来， inside`initTheme`方法使用`store.registerModule`方法来注册商店。

```js
StorageManager.init('claims');
store.registerModule('claims', claimsStore);
store.registerModule('homepage', homeStore);
store.registerModule('ui', uiStore);
store.registerModule('promoted', promotedStore);
```

- `WebShare`从 移动`@vue-storefront/core/modules/social-share/components/WebShare.vue`到`@vue-storefront/src/themes/default/components/theme/WebShare.vue`。此组件用于`Product`此处找到的组件：`src/themes/default/pages/Product.vue`。在此文件`import`中，必须更新路径。
- 我们修复了产品价格的命名策略；以下字段已重命名：`special_priceInclTax`-> `special_price_incl_tax`, `priceInclTax`-> `price_incl_tax`, `priceTax`-> `price_tax`; 名称已保留并标记为@deprecated。**Vue Storefront 2.0rc-1**将**删除**这些字段。
- 我们`localStorage`通过引入新的配置变量减少了配额使用和错误处理：
- `config.products.disablePersistentProductsCache`不按 SKU 存储产品（默认情况下它是打开的）。无论如何，产品都缓存在 ServiceWorker 缓存中，因此`product/list`将填充内存缓存 ( `cache.setItem(..., memoryOnly = true)`)；
- `config.seo.disableUrlRoutesPersistentCache`- 不存储 url 映射；无论如何，它们都存储在内存缓存中，因此不会向后端发出额外的请求以进行 url 映射；然而，它可能会导致一些问题的URL在离线模式下（离线模式主屏幕上安装PWA得到了重新加载，在内存中缓存将被清除，所以不会有可能是URL映射路由;然而同样喜欢用`product/list`的ServiceWorker 缓存无论如何都应该填充 url 映射）；
- `config.syncTasks.disablePersistentTaskQueue`不在服务工作者中存储网络请求队列。目前只有库存检查和用户数据更改使用此队列。它引入的唯一缺点可能与离线模式有关，并且这些任务在连接建立后不会重新执行，但只是在离线时页面重新加载的情况下（是的，使用 ServiceWorker 可能会发生这种情况；`syncTasks`不能重新执行） - 从 SW 填充到缓存中）
- 我们已将文件从 /store/lib 移至 /lib。基本上要从新目录中使用它，您现在必须从而`@vue-storefront/core/lib/store/`不是`@vue-storefront/core/store/lib/`. 这些核心文件已更改：

```js
core/build/webpack.base.config.ts
core/lib/sync/task.ts
core/lib/storage-manager.ts
core/modules/catalog/helpers/search.ts
core/modules/catalog/store/attribute/mutations.ts
core/modules/catalog/store/category/actions.ts
core/modules/catalog/store/category/mutations.ts
core/modules/catalog/store/product/actions.ts
core/modules/catalog/store/tax/mutations.ts
core/modules/compare/store/actions.ts
core/modules/order/store/mutations.ts
core/modules/order/index.ts
core/modules/wishlist/store/actions.ts
```

如果由于某些原因您不想`localStorage`重新启用`Products by SKU`, `Url Routes`and `SyncTasks`- 请`false`在您的`config/local.json`.

- 新的页面未找到处理需要更新主题中的 router/index.js。
- 引入了`config.ssr.lazyHydrateFor`带`category-next.products`值的选项，负责补水产品列表并仅在客户端加载它们。这意味着`__INITIAL__STATE__`. 它默认启用。
- 模块: `Review`, `Mailer`, `Order`, `RecentlyViewed`,`InstantCheckout`不再默认加载到主包中，因为它们在相关页面上按需加载。
- 身份验证保护从用户模块路由器移动到`MyAccount`页面混合。
- 该干将`cmsBlocks`，`cmsBlockIdentifier`，`cmsBlockId`已被弃用。请改用`getCmsBlocks`, `getCmsBlockIdentifier`, `getCmsBlockId`。
- “订单编号”、“价格”、“选择尺码”、“您登录的身份”和“商品”的翻译已更改，它们现在包含值的占位符。请参考[这个提交 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/pull/3550/commits/366d31bf28a1e27a7f14b222369cba8fe0a6d3e0)为了调整他们，否则他们可能会迷路。
- `i18n.currencySignPlacement`配置值被替换，`i18n.priceFormat`所以价格格式变得更加灵活
- 自定义主题中需要修改主题初始化
  - 删除该行`RouterManager.addRoutes(routes, router, true)`。这现在在 中处理`setupMultistoreRoutes`，包括默认存储。
  - 可选地给予主题路由优先级，以确保它们在有任何冲突时覆盖模块路由。例如`setupMultistoreRoutes(config, router, routes, 10)`。
  - 有关`/src/themes/default/index.js`完整示例，请参阅。
- 在`storeView`配置中，没有更多`disabled`用于特定语言配置的标志。如果`storeView`存在特定配置，将显示其他语言的链接。
- 通过`entities.category.filterFields`在 local.json 中设置，可以全局过滤类别，从不加载，例如`"filterFields": { "is_active": true }`。
- 通过`entities.category.breadcrumbFilterFields`在 local.json 中设置，可以在 Breadcrumbs 中过滤类别，例如`"breadcrumbFilterFields": { "include_in_menu": true }`。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-10-1-10-4)1.10 -> 1.10.4

我们`localStorage`通过引入新的配置变量减少了配额使用和错误处理：

- `config.products.disablePersistentProductsCache`不按 SKU 存储产品（默认情况下它是打开的）。无论如何，产品都缓存在 ServiceWorker 缓存中，因此`product/list`将填充内存缓存 ( `cache.setItem(..., memoryOnly = true)`)；
- `config.seo.disableUrlRoutesPersistentCache`- 不存储 url 映射；无论如何，它们都存储在内存缓存中，因此不会向后端发出额外的请求以进行 url 映射；然而，它可能会导致一些问题的URL在离线模式下（离线模式主屏幕上安装PWA得到了重新加载，在内存中缓存将被清除，所以不会有可能是URL映射路由;然而同样喜欢用`product/list`的ServiceWorker 缓存无论如何都应该填充 url 映射）；
- `config.syncTasks.disablePersistentTaskQueue`不在服务工作者中存储网络请求队列。目前只有库存检查和用户数据更改使用此队列。它引入的唯一缺点可能与离线模式有关，并且在建立连接后不会重新执行这些任务，但只是在离线时页面重新加载的情况下（是的，使用 ServiceWorker 可能会发生这种情况；`syncTasks`不能重新执行） - 从 SW 填充到缓存中）

如果由于某种原因你wan't有`localStorage`上背部`Products by SKU`，`Url Routes`和`SyncTasks`-请juset设置这些变量回`false`你`config/local.json`。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-9-1-10)1.9 -> 1.10

- 事件`application-after-init`现在由事件总线发出，而不是由根 Vue 实例（应用程序）发出，因此您现在需要监听`Vue.prototype.$bus`( `EventBus.$on()`)
- 目前支持的最低节点版本是 8.10.0，
- 模块 Mailchimp 被删除以支持时事通讯。`local.json`key 下的配置`mailchimp`移到 key `newsletter`。
- 在多商店模式下，现在可以使用`appendStoreCode`配置选项跳过将商店代码附加到 url 的可能性。要保持原始行为，应将其设置为 true。- @lukeromanowicz (#3048)。
- 将`cart/addItem`不再显示错误信息-请使用`diffLog.clientNorifications`，而不是更新UI（看看的`AddToCart.ts`一个参考）
- 请确保您的`AddToCart.vue`组件已`notifyUser`定义用于在添加到购物车时显示错误/成功消息的方法。默认实现是：

```js
    notifyUser (notificationData) {
      this.$store.dispatch('notification/spawnNotification', notificationData, { root: true })
    }
```

- getter`cart/totals`已被替换为`cart/getTotals`- @pkarw (#2522)
- getter`cart/coupon`已被替换为`cart/getCoupon`- @pkarw (#2522)
- getter`cart/totalQuantity`已被替换为`cart/getItemsTotalQuantity`- @pkarw (#2522)

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-8-1-9)1.8 -> 1.9

- 为友好的 URL 添加了 Url Dispatcher 功能。当`config.seo.useUrlDispatcher`设置为 true 时，`product.url_path`and`category.url_path`字段用作绝对 URL 地址（不再有`/c`和`/p`前缀）。检查最新`mage2vuestorefront`快照并**重新导入您的产品**以正确设置`url_path`字段
- `cart.multisiteCommonCart` 配置属性更改为 `storeViews.commonCache`
- 创建 VS 模块的方式已更改为使用工厂方法而不是显式对象创建。尽管该功能向后兼容，但我们强烈鼓励所有开发人员重构他们的模块以使用新语法。

使用工厂方法创建新模块的过程如下所示：

```js
import { createModule } from '@vue-storefront/core/lib/module'

const moduleConfig: VueStorefrontModuleConfig = {
  // VS module config
}

const module = createModule(moduleConfig)
```

- `@vue-storefront/store`包已折旧。只需将导入更改为`@vue-storefront/core/store`.
- `breadCrumbRoutes` 助手已重构为 `formatBreadCrumbRoutes`
- 在 API 中验证失败的订单被假定为具有 http 代码 400 而不是 500
- 关于无效订单地址的通知消息现在使用邮件程序部分中配置的电子邮件而不是硬编码的电子邮件
- 在大多数结帐字段中添加了对 UTF8 字母和字母数字字符的验证
- 更新您的 local.json 配置并设置默认`api.url`路径，如果没有它，您可能会遇到弹性搜索查询的问题。

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#troubleshooting)故障排除

- 如果升级后出现 CORS 问题，请检查配置文件中的 elasticsearch url。可以在[此处](https://github.com/vuestorefront/vue-storefront/commit/77fc9c2765068303879c75ef9ed4a4b98f6763b6)找到该更改的最佳实践[（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/77fc9c2765068303879c75ef9ed4a4b98f6763b6)
- 如果应用程序崩溃，尤其是`vue devtools`在浏览器中打开时，请尝试设置`storeViews.commonCache`为`false`。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-7-1-8)1.7 -> 1.8

完整的变更日志[在这里](https://github.com/vuestorefront/vue-storefront/blob/master/CHANGELOG.md)可用[（打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/master/CHANGELOG.md)

- `store/types`已移至名为`core/types`.
- `store/lib/search`已移至`core/lib/search`。
- `store/lib/multistore.ts` 已[移动]到（https://github.com/patzick/vue-storefront/commit/d42cdc44fc204dd10b173894d52dbeff244913f5#diff-87917f882ffc57fb755b1cc82ffa9e28L11） `core/lib/multistore.ts`
- 新[款式 （打开新窗口）](https://github.com/patzick/vue-storefront/commit/d42cdc44fc204dd10b173894d52dbeff244913f5#diff-ae72dc903f169eb56d716cd5ac99df35R1)表单元素文件
- 删除了未使用的`src/themes/default/filters/index.js`文件。检查您是否也没有使用它。
- `src/themes/default/resource/head.js` 已移至 `src/themes/default/head.js`
- `src/themes/default/index.basic.template.html` 已移至 `src/themes/default/templates/index.basic.template.html`
- `src/themes/default/index.minimal.template.html` 已移至 `src/themes/default/templates/index.minimal.template.html`
- `src/themes/default/index.template.html` 已移至 `src/themes/default/templates/index.template.html`

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-6-1-7)1.6 -> 1.7

从 Vue Storefront 1.7 开始，我们更改了缓存策略和离线就绪功能：

- 默认情况下，Elasticsearch 查询使用`GET`method执行，因此由 Service Worker 缓存（`config.elasticsearch.queryMethod`- 将其设置为 POST 以获取先前的行为，如果您使用的是 graphql）。
- 默认情况下，产品和查询缓存`LocalStorage`设置为 4MB ( `config.server.elasticCacheQuota`)的配额。如果设置了存储配额，则使用 LRU 算法每 30 秒执行一次缓存清除。大多数浏览器的本地存储限制为 5MB。
- 我们添加了`config.server. disablePersistentQueriesCache`，`true`默认设置为。当这个选项打开时，我们不会将 Elasticsearch 结果存储在本地缓存中，因为结果默认缓存在 Service Worker 缓存中。
- `module.extend`已更改为`extendModule`. 您可以在 中找到使用示例`src/modules/index.ts`。
- [路线 （打开新窗口）](https://github.com/patzick/vue-storefront/commit/a97eb11868de2915e86d57c4279caf944d4de422#diff-a334a7caeb7f61836f8c1178d92de3e0),[布局 （打开新窗口）](https://github.com/patzick/vue-storefront/commit/a97eb11868de2915e86d57c4279caf944d4de422#diff-48863b9fe31d7713222ec5709ef5a4fa)和组件，它们在页面渲染时不可见，现在在需要时加载。
- 每个 store 操作都应该通过 dispatch action 来完成。`category/mergeSearchOptions`在操作`store.state.category.current_product_query`某处时调用 store dispatch on 。
- [这里 （打开新窗口）](https://github.com/patzick/vue-storefront/commit/a97eb11868de2915e86d57c4279caf944d4de422)都是默认主题的变化

向后兼容性：要反转到 1.0-1.6 行为：

- 设置`config.server.disablePersistentQueriesCache`= `false`,
- 设置`config.elasticsearch.queryMethod`=`POST`
- 设置`config.localForage.defaultDrivers.elasticCache`=`INDEXEDDB`

**注意：**由于 Service Workers 和缺乏包预取（包延迟加载），离线模式可能无法在开发模式 (localhost) 中正常工作。

在 1.7 中，加载在产品页面上的属性描述符的数量是有限的，并且会根据产品中使用的字段进行动态调整。此行为不应对您的应用产生任何负面影响；但是，如果您没有`attribute/list`根据默认加载的所有属性（最高 1.6）显式使用该操作，则可能会导致问题。您可以通过设置`config.entities.product.useDynamicAttributeLoader=false`. 详情：[#2137（打开新窗口）](https://github.com/vuestorefront/vue-storefront/pull/2137/files)

动态类别预取（#2076）。从 Vue Storefront 1.7 开始，我们添加了一个配置选项`config.entities.category.categoriesDynamicPrefetch`（默认设置为`true`）。此选项切换获取类别树的方式。以前，我们正在获取完整的类别树。在某些情况下，它甚至可以生成几 MB 的有效载荷。目前有了这个选项，我们会在用户浏览类别树时按需预取类别。

**注意：**由于我们不再生成`category.slug`客户端，我们需要有`category.url_key`唯一的字段。如果您的 Magento2 url_keys 是唯一的，它将无需任何更改即可工作。如果没有 - 请使用[mage2vuestorefront （打开新窗口）](https://github.com/vuestorefront/mage2vuestorefront)重新导入类别。有一个新的`categories`导入器选项`--generateUniqueUrlKeys`，默认设置为 true。

随着 1.6 提供的新模块架构，我们[更新了支付模块指南 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/pull/2135). 如果您使用了自定义支付（以及基本上任何其他）扩展，请确保您已经将它们移植到[新的模块架构中 （打开新窗口）](https://docs.vuestorefront.io/guide/modules/introduction.html).

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-5-1-6)1.5 -> 1.6

在 1.6 中，我们引入了新的模块化架构，并将大部分特定于主题的逻辑从核心移到了默认主题。这可能是 VS 历史上最大的更新，也是让未来升级更加无缝的第一步。

由于结构变更，`core/components`以及`core/store/modules`文件夹取出并重组为模块（`core/modules`）。在大多数情况下，组件 API 保持不变（如果不是，我们在`core/compatibility/components`文件夹中提供了一个 API 桥接器，它允许您在不更改主题的情况下从新功能中受益）。最好在迁移后查找引用已删除文件夹的导入，以确保我们进行了完整更新。

总体而言，默认主题的主题升级需要更改105个文件，但其中85%的更改只是核心组件的新导入路径，这使得此更新耗时但易于遵循且无风险。

[这里 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f)您可以找到有关主题中需要更改哪些内容以支持 VS 1.6 的详细信息（作为带有注释的升级提交）。

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#global-changes)全球变化

- 通知现在基于 Vuex Store 而不是 Event Bus。我们还将硬编码通知从核心拉到主题。

更改每个组件：

```js
this.$bus.$emit('notification',
```

到：

```js
this.$store.dispatch('notification/spawnNotification',
```

更改每个商店：

```js
EventBus.$emit('notification',
```

到：

```js
rootStore.dispatch('notification/spawnNotification',
```

并确保您正在导入`rootStore`.

- 非 SSR 路由的延迟加载现在可用。

您现在可以[使用动态导入来延迟加载非 SSR 路由 （打开新窗口）](https://router.vuejs.org/guide/advanced/lazy-loading.html). 您可以[在此处](https://github.com/vuestorefront/vue-storefront/tree/develop/src/themes/default/router)找到默认主题中的示例[（打开新窗口）](https://github.com/vuestorefront/vue-storefront/tree/develop/src/themes/default/router)

- 扩展现在被重写为模块（扩展系统将在 1.7 中折旧）。

如果您没有直接修改任何扩展，则无需更改任何内容。如果进行了此类更改，则可能需要将扩展重写为模块。

- 旧的事件总线移动到兼容性文件夹。从现在开始，我们将尝试在没有它的情况下创建新功能，并在可能的情况下慢慢贬值事件总线。它将被一些具有事件自动建议支持的基于模块的增强机制所取代。

将所有`@vue-storefront/core/plugins/event-bus`导入更改为`@vue-storefront/core/compatibility/plugins/event-bus`

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#components-that-were-moved-or-the-api-was-changed-and-the-compatibility-component-was-created)移动的组件或更改了 API 并创建了兼容性组件。

所需操作：更改导入路径。如果有其他更改，请单击组件名称以查看如何更新。

- [`AddToCart.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-16a4dd1cbf1aaf74e001e6541fb27725)
- [`Breadcrumbs.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-fa33732560b7c39ea7854f701c4187bf)
- [`ColorSelector.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-551ae89c6d9e297a662749ee02676d45)
- [`GenericSelector.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-cbd08cdda068c587e3146bb3441e2161)
- [`NewsletterPopup.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-7b6cae3e664a647ff7397d6692e61cd6)
- [`Notification.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-d91127b094ff36e25dd94834c3aded6a)+`exec`改为`execAction`, 添加`execAction`
- [`Overlay.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-66a3ae90ace32b95ebe4513c496f76ce)
- [`PriceSelector.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-f564bd3cf6c2687c23c442d1363fe97b)
- [`ProductAttribute.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-b9783243d8666d5b2e46df608e6ace48)
- [`ProductCustomOptions.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-14db476c8821b640e674f1e655340de5)
- [`ProductGallery.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-66a4dfcf61217934307df12e9e3f14c6)
- [`SizeSelector.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-a83c265a63b7b594b5052ec61907cde1)
- [`SortBy.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-5dab270f8342facd10835e828e5d7509)+ 从下拉列表更改为选择
- [`ValidationError.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-e80a538151f16af10b20efa810ae0bc3)
- [`Login.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-3ac818c5cd6c41a9c9d7a3acba41cdb5)
- [`Category/Sidebar.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-88e78ea0dd0f96c15c4a00d29922e44c)+ 增加了清除所有过滤器的可能性
- [`CartSummary.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-bacd489920bede6d60bc9ce0b165e517)
- [`OrderReview.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-958fa5f4d0d271422146a86119bde82d)+ 通知从核心移到主题
- [`Payment.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-878b5e4180d8f997d0b57a7dc5d28154)
- [`PersonalDetails.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-d8651354142bff547c667cdab2e87a9f)
- [`Checkout/Product.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-a08ecdd137cc1b32d02d458e3ae22079)
- [`Shipping.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-a83c265a63b7b594b5052ec61907cde1)
- [`AccountIcon.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-b25a4326cbb2102f3293084aefe6d4c8)
- [`CompareIcon.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-4180179a247fd8ebb816f4d8e94e6c5b)
- [`HamburgerIcon.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-39d690ab85a291546f5ebe1606250fb5)
- [`MicrocartIcon.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-ddcf89d0ca46b06824190f07c87f6031)
- [`Returnicon.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-68dfc0097a84464e2f8196d0948b4a03)
- [`WishlistIcon.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-fabd1714a4872a2bcf26619adbe0709c)
- [`Microcart.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-ffba5dcba1456c20f565e314790cd450)
- [`Microcart/Product.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-5715f58dacfe621ce8d056e382f1be8b)
- [`MyNewsletter.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-48b9d7ff2e2e8e6cf6965fd582e51957)
- [`MyOrder.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-a8dbaeacd2cf4fb6440959d7827372fa)
- [`MyOrders.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-4d60c889f1362249fc19756d60f8f9b1)
- [`MyProfile.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-677b7e3129afc1c974c3bd08069662c7)
- [`MyShippingDetails.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-5ed705e03a497368b98d9ce41ec378de)
- [`Related.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-c1703e08c80fcacd8135eeb6d707aa95)+`refreshList`方法改变
- [`SearchPanel.gql.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-2020399a5c1abfc37c176bfcc5912293)
- [`SearchPanel.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-e2ff52db282530838ffce57893ed4a77)
- [`SidebarMenu.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-c341122656ef878fc532a5c34348a1ec)+错误修复（隐藏当前活动菜单下方的更长菜单），直接路由器链接而不是事件
- [`Wishlist/Product.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-7c0514d730223832fd2e1fae9d5f2068)
- [`Wishlist.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-8dc4f61d36ae2b2ffc2a4c4603e844b8)
- [`Collection.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-26a650b112a3b01efd1ff3a5c752aba1)
- [`Home.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-91bc0c9fe9fa95dd88900beff8975200)

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#components-that-were-moved-from-core-to-theme)从核心移动到主题的组件

所需操作：添加移动的内容并删除核心导入。如果有其他更改，请单击组件名称以查看如何更新。

- [`Loader.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-a2791ef5c57fb2459362720b4a624e53)
- [`Modal.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-527c2bb9d04213a2aaf1aac75673bc71)+ 删除了静态内容
- [`ProductLinks.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-9ccb222e8d3decebb067729ee935899a)
- [`ProductListing.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-000bc323621dca4883033c0e91f9125a)
- [`ProductTile.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-4049e5b38efd1a5d0215fd71e32136a3)+ 核心导入移至模块
- [`ProductSlider.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-624e75f15bdb9b2f7d5f417138c9f0ec)
- [`ForgotPass.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-e2fbfb707a274bea8b9f7af3e3c57032)
- [`Register.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-f5266afaec9d55f2fc93cf3b874b7288)+ 核心导入移至模块
- [`SignUp.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-df0c798d67a63c4eef4d3141393db5f9)
- [`BaseCheckbox.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-23e3b8989b402a011ee4cb3f985fa3ce)
- [`BaseInput.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-d209385c453bdf31b89bc51772bd2bda)
- [`BaseRadioButton.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-1493dcb05a06ce313807003d1774fa14)
- [`BaseSelect.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-c4c37e440fd8ec3deeacef085b48ed9f)
- [`BaseTextArea.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-0ea48ec8c1545db8cbdacfd348f8bf75)
- [`Header.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-5f4560c69df1a5f6d97f0b064b9b792f)
- [`MainSlider.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-19c964e13db826a1358f30839627986b)
- [`Reviews.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-d8861516b2c7dfc547b91e1066ca4755)+ 空数组而不是 null，核心导入路径已更改
- [`Compare.vue`（打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-0aa476fa2f0314806d4afd620c80be54)

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#other)其他

- [`ProductBundleOption.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-32809917812e7c8c4571be70a693d65b)- 从`ProductBundleOptions.vue`组件中拆分单个选项。
- [`ProductBundleOptions.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-7ccee94c636406b1a82feddea3a7f520)- 单个选项移至单独的组件`ProductBundleOption.vue`，移至模块。
- [`ThankYouPage.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-84c29c5b22568c31b021dc864221563f)添加了订单 ID 显示、订单确认、从核心提取通知并添加了邮件确认
- [`main.scss` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-c65e47159738f3552a22f16ec5c5974f)删除重复的 flexbox 网格
- [`index.template.html` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-bf0804a2329350f8e9d9071e40cf1429)（+ 您可能拥有的所有其他模板，例如最小、基本等），已添加 `output.appendHead(), renderStyles()`
- [`Category.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-eb709969add1ca4a266ac072cddde954)通知移至主题
- [`Checkout.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-1c6544c28d075f275812201fa42755de)通知移至主题
- [`MyAccount.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-bb873f532ed9a2efbb157af79a70e0f7)通知移至主题
- [`Product.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-174db65df8e0c43df20b73b5bf16881b)可能影响标记的属性变量名称的细微变化，通知移至主题
- [`Static.vue` （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/cc17b5bfa43a9510815aea14dce8bafac382bc7f#diff-a3a9b6eeeba4c915c1ea1aae1c489ecc)静态页面不再使用降价文件。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-4-1-5)1.4 -> 1.5

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#modifications)修改

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#new-modules-api)新模块 API

在 1.5.0 中，我们引入了一个新的、经过大量重构的模块 API。我们试图保持旧的主题组件向后兼容，因此现在您可以在`/core/components`引用`/modules/<module>/components`原始主题时查看一些“模拟”组件。请阅读[模块的工作原理和结构，](https://docs.vuestorefront.io/v1/guide/modules/introduction.html)以检查它是否暗示您的主题有任何更改。尽管看起来有很多更改（添加/删除/重命名了许多文件），但它不应该影响您的自定义代码。

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#new-newsletter-module)新的通讯模块

现有的时事通讯集成模块非常混乱和凌乱。@filrak 从头开始重写它。如果您依赖现有的时事通讯模块逻辑/事件/等，它可能会影响您的代码（低概率）。

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#memory-leaks-fixed)内存泄漏已修复

我们使用 #1882 修复了 SSR 内存泄漏。它不应影响您的自定义代码，但如果您修改了任何 SSR 功能，请确保一切仍然正常。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-3-1-4)1.3 -> 1.4

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#modifications-2)修改

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#graphql)图形语言

我们添加了 GraphQL 支持。请阅读有关[GraphQL 行动计划的更多信息](https://docs.vuestorefront.io/v1/guide/basics/graphql.html)。从此版本开始，**不推荐使用****bodybuilder**包。您应该使用可用于 API 和 GraphQL 端点的**SearchQuery**内部类。阅读有关[如何查询数据的](https://docs.vuestorefront.io/v1/guide/data/elastic-queries.html)更多[信息](https://docs.vuestorefront.io/v1/guide/data/elastic-queries.html)。

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#ssr-advanced-output-and-cache)SSR：高级输出和缓存

此更改不涉及移植代码所需的任何操作，但请注意我们支持[SSR 缓存 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/develop/doc/SSR Cache.md)+[动态布局变化 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/develop/doc/Layouts and advanced output operations.md)等。如果您使用的是主题的修改版本，则在不更新`themes/YourTheme/App.vue`到新格式的情况下几乎无法使用这些（查看默认主题以获取详细信息）。

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#reviews)评论

我们添加了评论支持，但是，Magento 2 在 REST API 中仍然缺乏评论支持。要启动并运行评论，请将 https://github.com/divanteLtd/magento2-review-api 添加到您的 Magento 2 实例。

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#microcart)微型车

1. 我们将优惠券代码的核心功能移至 API 模块：
   - **优惠券**现在计算值是**appliedCoupon**（[阅读更多 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/master/doc/api-modules/cart.md))
   - **removeCoupon** ([阅读更多 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/master/doc/api-modules/cart.md))
   - **申请优惠券**（[阅读更多 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/master/doc/api-modules/cart.md))
   - **总计**->**购物车****总计**（[阅读更多 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/master/doc/api-modules/cart.md))
   - **运输**->**购物车****运输**（[阅读更多 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/master/doc/api-modules/cart.md))
   - **付款**->**购物车****付款**（[阅读更多 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/master/doc/api-modules/cart.md))
2. 我们将负责 UI 的方法移动/重命名为默认主题：
   - **addDiscountCoupon** - 切换优惠券表格
   - **removeCoupon** -> **clearCoupon** - 通过调度 removeCoupon API 方法和切换优惠券表单删除优惠券
   - **applyCoupon** -> **setCoupon** - 通过 dispatch applyCoupon API 方法提交优惠券表格
   - **enterCoupon** - 被移除了，因为@keyup="enterCoupon" 我们改为@keyup.enter="setCoupon"
3. 我们将 $emit 与有关应用的Coupon 和removedCoupon 的通知从Vuex 商店移动到默认主题。现在applyCoupon 和removeCoupon 返回promise，你可以自己处理。
4. 我们将 VueOfflineMixin 和 onEscapePress 混入移动到主题组件。核心组件现在从 UI 内容中清除了。
5. 我们已经取代一个方法`Microcart`- `cartTotals`- >`totals`

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#assets)资产

1. 我们从`core/assets`. 从现在开始，我们只使用`your-theme/assets`.

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#store)店铺

1. 我们将 socialTiles Vuex 商店从核心移到主题，因为它特定于主题。

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#i18n)国际化

1. 我们删除了核心的所有特定于主题的翻译。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-2-1-3)1.2 -> 1.3

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#changes)变化

1. 我们从带有在线状态信息的 client-entry.js 中删除了事件发出。相反，我们现在使用[vue-offline （打开新窗口）](https://github.com/filrak/vue-offline)混合。[第1494章（打开新窗口）](https://github.com/vuestorefront/vue-storefront/issues/1494)
2. 我们从 Microcart.js 中删除了 isOnline 变量。相反，我们现在使用[vue-offline 中的](https://github.com/filrak/vue-offline)变量[ （打开新窗口）](https://github.com/filrak/vue-offline)混合。[第1494章（打开新窗口）](https://github.com/vuestorefront/vue-storefront/issues/1494)

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#upgrade-step-by-step)逐步升级

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#global-vs-replaced-with-rootstore-and-config-was-moved-to-config)`global.$VS`替换为`rootStore`并`config`移至`config`

要访问 rootStore，请通过以下方式导入

```
import config from 'config'
```

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#cms-extenstion-was-renamed-to-extension-magento2-cms)cms 扩展重命名为 extension-magento2-cms

必须在`CustomCmsPage.vue`组件中将 CmsData 的导入更改为：

```
import CmsData from '@vue-storefront/extension-magento2-cms/components/CmsData'
```

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-1-1-2-release-notes)1.1 -> 1.2（[发行说明 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/releases/tag/v1.2.0))

没有引入重大更改。不需要特殊处理😃

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-0-1-1-release-notes)1.0 -> 1.1（[发行说明 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/releases/tag/v1.1.0))

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#modifications-3)修改

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#plugins-registration-simplified)插件注册简化

而不是直接在此文件中`{theme}/plugins/index.js`使用导出对象`Vue.use(pugin)`（[docs （打开新窗口）](https://github.com/vuestorefront/vue-storefront/blob/master/doc/Working with plugins.md))

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#microcart-logic-moved-to-api-module-partially)Microcart 逻辑移至 API 模块（部分）

从 Microcart 开始，我们将大部分逻辑移至核心模块并对其进行单元测试。[阅读更多 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/issues/1213).

`Microcart.js`核心组件和`Microcart.vue`默认主题组件中发生的更改：

- `closeMicrocart` 重命名为 `closeMicrocartExtend`
- `items` 重命名为 `productsInCart`
- `removeFromCart`添加到核心 Microcart 的方法

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#theme-app-extend-js-removed)`theme/app-extend.js` 移除

这是多余的。

#### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#theme-service-worker-ext-js-moved-to-theme-service-worker-index-js)`{theme}/service-worker-ext.js` 搬去 `{theme}/service-worker/index.js`

现在它反映了`core/`文件夹结构，这是所需的行为。

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#vue-storefront-api-docker-support-has-been-extended)vue-storefront-api docker 支持已扩展

我们添加的可能性在运行`vue-storefront-api`中多克尔（以前，就是弹性和Redis的图像是存在于完全`docker-compose.yml`，请阅读[README.md （打开新窗口）](https://github.com/vuestorefront/vue-storefront-api)更多细节。

**请注意：**我们更改了`elasticsearch`配置文件部分的结构，移动`esIndexes`到`elasticsearch.indices`等。有一个自动迁移将通过运行自动更新您的配置文件：`yarn migrate`在`vue-storefront-api`文件夹中。

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#default-storage-of-the-shopping-carts-and-user-data-moved-to-localstorage)购物车和用户数据的默认存储移动到 localStorage

目前，有一个配置选项来设置默认的本地存储配置：https://github.com/vuestorefront/vue-storefront/blob/271a33fc6e712b978e10b91447b05529b6d04801/config/default.json#L148。如果您喜欢之前在 indexedDb 中存储购物车的行为，请将配置后端更改为`INDEXEDDB`.

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#mage2vuestorefront-improvements)mage2vuestorefront 改进

在[mage2vuestorefront 中](https://github.com/vuestorefront/mage2vuestorefront)添加了许多改进[ （打开新窗口）](https://github.com/vuestorefront/mage2vuestorefront)进口商。进口商。例如，固定 special_price 同步。对于此类更改，请更新[mage2vuestorefront （打开新窗口）](https://github.com/vuestorefront/mage2vuestorefront)并重新导入您的产品。我们还添加了动态按需索引。

### [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#new-features)新功能

我们添加了 [`vue-progressbar` （打开新窗口）](https://github.com/hilongjw/vue-progressbar)默认主题，可以在`App.vue`文件中找到。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-0rc-3-1-0-release-notes)1.0RC-3 -> 1.0（[发行说明 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/releases/tag/v1.0.0))

这是 Vue Storefront 的官方稳定版本。

1. 我们重命名`the core/components/*.vue`->`the core/components/*.js`
2. 我们重命名`the core/pages/*.vue`->`the core/pages/*.js`
3. 我们删除`corePage`和`coreComponent`佣工和创建ES-皮棉规则迁移的`import`报表自动（带`--fix`参数）

您应该替换之前版本中的 mixin 声明：

```vue
<script>
import { coreComponent } from '@vue-storefront/core/lib/themes';

export default {
  mixins: [coreComponent('blocks/MyAccount/MyOrders')],
};
</script>
```

到

```vue
<script>
import MyOrders from '@vue-storefront/core/components/blocks/MyAccount/MyOrders';

export default {
  mixins: [MyOrders],
};
</script>
```

1. 我们添加了 Multistore 支持。它不应该暗示对现有主题/扩展的任何重大更改（默认情况下它只是被禁用）。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-0rc-2-1-0rc-3-release-notes)1.0RC-2 -> 1.0RC-3（[发行说明 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/releases/tag/v1.0.0-rc.3))

此版本包含三个重要的重构工作：

1. 我们更改了用户帐户端点并添加了令牌更新机制，该机制由 `config.users.autoRefreshTokens`. 如果设置为 true 并且用户令牌将过期，VS 将尝试刷新它。
2. 我们分离了用户帐户端点，因此请将以下默认值复制`default.json`到您的`local.json`并设置正确的 API 端点：

```json
    "users": {
      "autoRefreshTokens": true,
      "endpoint": "http://localhost:8080/api/user",
      "history_endpoint": "http://localhost:8080/api/user/order-history?token={{token}}",
      "resetPassword_endpoint": "http://localhost:8080/api/user/reset-password",
      "changePassword_endpoint": "http://localhost:8080/api/user/change-password?token={{token}}",
      "login_endpoint": "http://localhost:8080/api/user/login",
      "create_endpoint": "http://localhost:8080/api/user/create",
      "me_endpoint": "http://localhost:8080/api/user/me?token={{token}}",
      "refresh_endpoint": "http://localhost:8080/api/user/refresh"
    },
```

端点也由 设置，`yarn installer`因此您可以尝试使用此命令重新安装 VS。

1. 我们通过限制每次从后端加载到 JSON 对象中的字段来优化性能。请查看`config/default.json`如果您的应用程序需要/使用的某些字段丢失，请将以下片段复制到`config/local.json`并添加必填字段：

```json
    "entities": {
      "optimize": true,
      "twoStageCaching": true,
      "category": {
        "includeFields": [ "children_data", "id", "children_count", "sku", "name", "is_active", "parent_id", "level" ]
      },
      "attribute": {
        "includeFields": [ "attribute_code", "id", "entity_type_id", "options", "default_value", "is_user_defined", "frontend_label", "attribute_id", "default_frontend_label", "is_visible_on_front", "is_visible", "is_comparable" ]
      },
      "productList": {
        "includeFields": [ "type_id", "sku", "name", "price", "priceInclTax", "original_price_incl_tax", "id", "image", "sale", "new" ],
        "excludeFields": [ "configurable_children", "description", "configurable_options", "sgn", "tax_class_id" ]
      },
      "productListWithChildren": {
        "includeFields": [ "type_id", "sku", "name", "price", "priceInclTax", "original_price_incl_tax", "id", "image", "sale", "new", "configurable_children.image", "configurable_children.sku", "configurable_children.price", "configurable_children.special_price", "configurable_children.price_incl_tax", "configurable_children.special_price_incl_tax", "configurable_children.original_price", "configurable_children.original_price_incl_tax", "configurable_children.color", "configurable_children.size" ],
        "excludeFields": [ "description", "sgn", "tax_class_id" ]
      },
      "product": {
        "excludeFields": [ "updated_at", "created_at", "attribute_set_id", "status", "visibility", "tier_prices", "options_container", "url_key", "msrp_display_actual_price_type", "has_options", "stock.manage_stock", "stock.use_config_min_qty", "stock.use_config_notify_stock_qty", "stock.stock_id",  "stock.use_config_backorders", "stock.use_config_enable_qty_inc", "stock.enable_qty_increments", "stock.use_config_manage_stock", "stock.use_config_min_sale_qty", "stock.notify_stock_qty", "stock.use_config_max_sale_qty", "stock.use_config_max_sale_qty", "stock.qty_increments", "small_image"],
        "includeFields": null
      }
    },
```

如果`optimize`设置为 false，则返回到之前的行为（获取所有字段）。

1. 另一个很酷的功能是`twoStageCaching`默认启用的。这意味着对于 Category 页面，VS 仅获取显示 ProductTiles 所需的最少 JSON 字段数。不久之后，它通过第二个请求下载完整的对象，将它们存储在本地缓存中。
2. 我们调整了 Service Worker 以更好地缓存应用程序；如果您的主页现在缓存在软件中（以前不是），它有时会令人沮丧。随意`Clear Storage`在你的开发者工具中使用 😃
3. 该`mage2vuestorefront`工具得到了更新，现在它正在为`media_gallery`每个产品加载额外的媒体。我们还在产品页面上放置了一些 MediaGallery 组件。

7.产品和类别页面被重构。将所有逻辑移至 Vuex 存储是一项大规模重构，因此如果您使用核心`fetchData`/`loadData`功能，您的代码可能会受到此更改的影响。

## [#](https://docs.vuestorefront.io/v1/guide/upgrade-notes/#_1-0rc-1-0rc-2-release-notes)1.0RC -> 1.0RC-2（[发行说明 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/releases/tag/v1.0.0-rc.2))

此版本带来了一些很酷的新功能（Magento 1.x 支持、Magento 2 外部结账、我的订单、折扣代码）以及一些小的重构。

不幸的是，重构带来了两个手动更改，需要在更新后应用于您的自定义主题。

在这里您可以查看**[我们如何将自己的 default_m1 主题迁移到 RC-2](https://github.com/vuestorefront/vue-storefront/commit/111519c04acec272657e7eefec7ea8405da95f13)**的**[示例 （打开新窗口）](https://github.com/vuestorefront/vue-storefront/commit/111519c04acec272657e7eefec7ea8405da95f13)**.

1. 我们改变了`ColorButton`，`SizeButton`，`PriceButton`在`core`到`ColorSelector`，`SizeSelector`，`PriceSelector`并增加了`GenericSelector`对所有其他属性类型。由于此更改，`coreComponent('ColorButton')`必须将其更改为`coreComponent('ColorSelector')`等。
2. 我们为主题添加了 Vuex Stores 可扩展性。如果您收到以下构建错误：

```text
ERROR in ./core/store/index.js
Module not found: Error: Can't resolve 'theme/store' in '***/vue-storefront/core/store'
```

这意味着，您需要将模板存储复制到：`<Your custom theme folder>/store`。